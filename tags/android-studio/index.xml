<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Curiosity &amp; the Geek Blog</title>
    <link>/tags/android-studio/index.xml</link>
    <description>Recent content on Curiosity &amp; the Geek Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="/tags/android-studio/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Hooking into Android Studio&#39;s Gradle build process</title>
      <link>/blog/hooking-into-android-gradle-build/</link>
      <pubDate>Sun, 21 Feb 2016 01:29:00 +0530</pubDate>
      
      <guid>/blog/hooking-into-android-gradle-build/</guid>
      <description>

&lt;h2 id=&#34;background&#34;&gt;Background&lt;/h2&gt;

&lt;p&gt;If you want to automate steps to re-build data-files or assets for an Android app every time
the app gets built in Android Studio, you need to hook into the Gradle based build process.
While Gradle itself has &lt;a href=&#34;https://docs.gradle.org/current/userguide/userguide.html&#34;&gt;impressive documentation&lt;/a&gt;,
it was not very clear initially how to hook into an Android app&amp;rsquo;s build process. This article shows how I
managed to make it work.&lt;/p&gt;

&lt;h2 id=&#34;issue&#34;&gt;Issue&lt;/h2&gt;

&lt;p&gt;I want to make an Android app which uses a &lt;a href=&#34;https://developer.android.com/guide/webapps/webview.html&#34;&gt;WebView&lt;/a&gt;
to display a webapp built on &lt;a href=&#34;https://facebook.github.io/react/&#34;&gt;React Framework&lt;/a&gt;. &lt;a href=&#34;https://github.com/facebookincubator/create-react-app&#34;&gt;Create React App&lt;/a&gt;
is a simple way to bootstrap a react app using &lt;a href=&#34;https://webpack.github.io/&#34;&gt;WebPack&lt;/a&gt; and
&lt;a href=&#34;https://babeljs.io/&#34;&gt;BabelJS&lt;/a&gt; to translate JSX to plain JS and bundle the code. The
Create React App scripts provides a simple live-rebuild and webserver feature for local development
and makes an &lt;code&gt;npm run build&lt;/code&gt; command available to generate an optimized build.&lt;/p&gt;

&lt;p&gt;Rather than host this webapp on a server, I would like to make it available locally under the &lt;code&gt;assets&lt;/code&gt;
folder in the Android app to minimize latency. I would also like the webapp automatically rebuilt
everytime I compile the android app and refreshed in the &lt;code&gt;assets&lt;/code&gt; folder.&lt;/p&gt;

&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;

&lt;p&gt;The &lt;a href=&#34;http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Android-tasks&#34;&gt;Android Gradle Plugin&lt;/a&gt;
unfortunately uses fancy features of the Gradle DSL to build a task based on build target configurations
at runtime making it difficult to hook onto one of the &lt;code&gt;:assemble&lt;/code&gt; or &lt;code&gt;:build&lt;/code&gt; tasks while compiling.&lt;/p&gt;

&lt;p&gt;However, one of the early tasks that runs during Android App compilation with Gradle is
called &lt;code&gt;:preBuild&lt;/code&gt; and allows us to reliably hook into it for running or own asset generation
routines.&lt;/p&gt;

&lt;p&gt;To do this, I appended the following at the bottom of &lt;code&gt;build.gradle&lt;/code&gt; of the android application.
I first create a Gradle &lt;a href=&#34;https://docs.gradle.org/current/dsl/org.gradle.api.tasks.Exec.html&#34;&gt;Exec&lt;/a&gt;
task which runs the &lt;code&gt;npm run build&lt;/code&gt; command in the directory containing the webapp sources. I then
create a Gradle &lt;a href=&#34;https://docs.gradle.org/current/dsl/org.gradle.api.tasks.Sync.html&#34;&gt;Sync&lt;/a&gt; that copies
the generated webapp files to the &lt;code&gt;assets&lt;/code&gt; folder. The &lt;code&gt;Sync&lt;/code&gt; task depends on the &lt;code&gt;Exec&lt;/code&gt; task. Finally
I make the Android build&amp;rsquo;s &lt;code&gt;:preBuild&lt;/code&gt; task depend on our &lt;code&gt;Sync&lt;/code&gt; task so that the assets are build
and copied before the Android app is compiled.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;task buildWebApp(type:Exec) {
    workingDir &#39;../../webapp&#39;
    commandLine &#39;npm&#39;, &#39;run&#39;, &#39;build&#39;
}

task syncWebApp(type: Sync, dependsOn:&#39;buildWebApp&#39;) {
    from &#39;../../webapp/build&#39;
    into &#39;src/main/assets/build&#39;
}

preBuild.dependsOn(syncWebApp)
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Making Android Studio (or Eclipse ADT) work on 64-bit Ubuntu Saucy 13.10 or Trusty 14.04</title>
      <link>/blog/android-studio-on-trusty/</link>
      <pubDate>Sun, 14 Sep 2014 06:10:34 +0530</pubDate>
      
      <guid>/blog/android-studio-on-trusty/</guid>
      <description>

&lt;h2 id=&#34;the-issue&#34;&gt;The Issue&lt;/h2&gt;

&lt;p&gt;Getting Android Studio (or Eclipse Android Development Tools) to run successfully on 64-bit (ie. amd64)
installations of the newer Ubuntu (or underlying Debian) distributions like Trusty Thar (14.04)
is not a very straightforward process. While the IDE you download itself will work assuming you have JDK
installed, it will throw a bunch of build errors when you try to build any app.&lt;/p&gt;

&lt;h2 id=&#34;why-does-this-happen&#34;&gt;Why does this happen&lt;/h2&gt;

&lt;p&gt;The build errors happen because the Android &lt;code&gt;build-tools&lt;/code&gt; are actually 32-bit (ie. i386) binaries dynamically linked
to several 32-bit libraries. For instance, this is what the the &lt;code&gt;file&lt;/code&gt; outputs on my installation
of the &lt;code&gt;aapt&lt;/code&gt; tool in the &lt;code&gt;build-tools&lt;/code&gt; folder within the sdk
    file aapt
    aapt: ELF 32-bit LSB  shared object, Intel 80386, version 1 (SYSV), dynamically linked
    (uses shared libs), for GNU/Linux 2.6.8, not stripped&lt;/p&gt;

&lt;p&gt;While the 64-bit installations of Linux can run 32-bit binaries, they do not come pre-installed with
the necessary 32-bit libraries pre-installed. Googling throws up dozens of posts advising installation
of the &lt;code&gt;ia32-libs&lt;/code&gt; but this advise is unfortunately outdated. Newer versions of Ubuntu from 13.10 Saucy
onwards have &lt;a href=&#34;http://askubuntu.com/questions/359156/how-do-you-run-a-32-bit-program-on-a-64-bit-version-of-ubuntu/359184#359184&#34;&gt;removed&lt;/a&gt;
the &lt;code&gt;ia32-libs&lt;/code&gt; package and rely fully on &lt;a href=&#34;https://wiki.debian.org/Multiarch&#34;&gt;Multiarch&lt;/a&gt; which is a
much more comprehensive solution.&lt;/p&gt;

&lt;h2 id=&#34;the-solution&#34;&gt;The Solution&lt;/h2&gt;

&lt;p&gt;To get Android Studio (or Eclipse ADT) build properly on the newer 64 bit Ubuntu releases like 13.10
Saucy or 14.04 Trusty you need to add the 32-bit i386 library dependencies as follows:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo dpkg --add-architecture i386
sudo apt-get install libc6:i386 libncurses5:i386 libstdc++6:i386 zlib1g:i386
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&amp;rsquo;s it! You shouldn&amp;rsquo;t get the build errors any more! Happy app development!&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>